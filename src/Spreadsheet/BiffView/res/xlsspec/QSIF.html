<html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8" /><title>QSIF: Query Table Field Formatting (807h)</title><link href="styles.css" rel="Stylesheet" type="text/css" /></head><body><div id="container"><h2>QSIF: Query Table Field Formatting (807h)</h2>     <p class="Text">Introduced in Excel 9 (2000) this is a <span class="CodeInlineChar">FRT </span> <span> record. It stores the information for formatting theindividual fields of a Query Table.  Aset of </span> <span class="CodeInlineChar">QSIF </span> </span> recordsimmediately follows the <span class="CodeInlineChar">QSIR </span> record.</p>     <p class="Text" style='background:#F3F3F3'><b><span style='font-family:Arial;'>Record Data </span></b></p><table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0" width="595" style='width:446.0pt; border-collapse:collapse;'> <tr>   <td width="62" style='width:46.15pt; border-bottom:solid windowtext 1.0pt;'>     <p class="Header">Offset</p>   </td>   <td width="88" style='width:65.85pt; border-bottom:solid windowtext 1.0pt;'>     <p class="Header">Name</p>   </td>   <td width="48" style='width:36.0pt; border-bottom:solid windowtext 1.0pt;'>     <p class="Header">Size</p>   </td>   <td width="397" style='width:298.0pt; border-bottom:solid windowtext 1.0pt;'>     <p class="Header">Contents</p>   </td> </tr> <tr>   <td width="62" style='width:46.15pt;'>     <p class="Text">4</p>   </td>   <td width="88" style='width:65.85pt;'>     <p class="Text"><span class="CodeInlineChar"><span style='font-size: 11.0pt;'>rt </span> </span></p>   </td>   <td width="48" style='width:36.0pt;'>     <p class="Text">2</p>   </td>   <td width="397" style='width:298.0pt;'>     <p class="Text">Record type; this matches the BIFF <span class="CodeInlineChar">rt </span> <span> in the first two bytes of the record;   =0807h </span></p>   </td> </tr> <tr>   <td width="62" style='width:46.15pt;'>     <p class="Text">6</p>   </td>   <td width="88" style='width:65.85pt;'>     <p class="Text"><span class="CodeInlineChar"><span style='font-size: 11.0pt;'>grbitFrt </span> </span></p>   </td>   <td width="48" style='width:36.0pt;'>     <p class="Text">2</p>   </td>   <td width="397" style='width:298.0pt;'>     <p class="Text"><span class="CodeInlineChar"><span style='font-size: 11.0pt;'>FRT </span> </span> flags; must be zero</p>   </td> </tr> <tr>   <td width="62" style='width:46.15pt;'>     <p class="Text">8</p>   </td>   <td width="88" style='width:65.85pt;'>     <p class="Text"><span class="CodeInlineChar"><span style='font-size: 11.0pt;'>grbit </span> </span></p>   </td>   <td width="48" style='width:36.0pt;'>     <p class="Text">4</p>   </td>   <td width="397" style='width:298.0pt;'>     <p class="Text">Union of flags; see table</p>   </td> </tr> <tr>   <td width="62" style='width:46.15pt;'>     <p class="Text">12</p>   </td>   <td width="88" style='width:65.85pt;'>     <p class="Text"><span class="CodeInlineChar"><span style='font-size: 11.0pt;'>idField </span> </span></p>   </td>   <td width="48" style='width:36.0pt;'>     <p class="Text">4</p>   </td>   <td width="397" style='width:298.0pt;'>     <p class="Text">ID number of the query table field; this is a unique identification tag</p>   </td> </tr> <tr>   <td width="62" style='width:46.15pt;'>     <p class="Text">16</p>   </td>   <td width="88" style='width:65.85pt;'>     <p class="Text"><span class="CodeInlineChar"><span style='font-size: 11.0pt;'>rgbEx </span> </span></p>   </td>   <td width="48" style='width:36.0pt;'>     <p class="Text">var</p>   </td>   <td width="397" style='width:298.0pt;'>     <p class="Text">Bytes reserved for extra information to be written by future versions of Excel; the size of this field is determined by <span class="CodeInlineChar">cbQsifSaved </span> in the parent <span class="CodeInlineChar">QSIR </span> record</p>   </td> </tr> <tr>   <td width="62" style='width:46.15pt;'>     <p class="Text">var</p>   </td>   <td width="88" style='width:65.85pt;'>     <p class="Text"><span class="CodeInlineChar"><span style='font-size: 11.0pt;'>rgbTitle </span> </span></p>   </td>   <td width="48" style='width:36.0pt;'>     <p class="Text">var</p>   </td>   <td width="397" style='width:298.0pt;'>     <p class="Text">Unicode string; this is the name of the field</p>   </td> </tr></table>     <p class="TableSpacingAfter">&nbsp; </p>     <p class="Text">The <span class="CodeInlineChar">grbit </span> field contains the following option flags:</p><table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0" width="595" style='width:446.0pt; border-collapse:collapse;'> <thead> <tr>   <td width="59" style='width:44.5pt; border-bottom:solid windowtext 1.0pt;'>     <p class="Header">Offset</p>   </td>   <td width="53" style='width:39.6pt; border-bottom:solid windowtext 1.0pt;'>     <p class="Header">Bits</p>   </td>   <td width="72" style='width:54.15pt; border-bottom:solid windowtext 1.0pt;'>     <p class="Header">Mask</p>   </td>   <td width="96" style='width:71.95pt; border-bottom:solid windowtext 1.0pt;'>     <p class="Header">Name</p>   </td>   <td style='width:235.8pt; border-bottom: solid windowtext 1.0pt;'>     <p class="Header">Contents</p>   </td> </tr> </thead> <tr>   <td width="59" style='width:44.5pt;'>     <p class="Text">0</p>   </td>   <td width="53" style='width:39.6pt;'>     <p class="Text">0</p>   </td>   <td width="72" style='width:54.15pt;'>     <p class="Text">0001h</p>   </td>   <td width="96" style='width:71.95pt;'>     <p class="Text"><span class="CodeInlineChar"><span style='font-size: 11.0pt;'>fUserIns </span> </span></p>   </td>   <td width="314" style='width:235.8pt;'>     <p class="Text">1= This column was inserted into the Query Table and is not in the query</p>   </td> </tr> <tr>   <td width="59" style='width:44.5pt;'>     <p class="Text">&nbsp; </p>   </td>   <td width="53" style='width:39.6pt;'>     <p class="Text">1</p>   </td>   <td width="72" style='width:54.15pt;'>     <p class="Text">0002h</p>   </td>   <td width="96" style='width:71.95pt;'>     <p class="Text"><span class="CodeInlineChar"><span style='font-size: 11.0pt;'>fFillDown </span> </span></p>   </td>   <td width="314" style='width:235.8pt;'>     <p class="Text">1= The formula in this column should be filled down/deleted up on a refresh</p>   </td> </tr> <tr>   <td width="59" style='width:44.5pt;'>     <p class="Text">&nbsp; </p>   </td>   <td width="53" style='width:39.6pt;'>     <p class="Text">2</p>   </td>   <td width="72" style='width:54.15pt;'>     <p class="Text">0004h</p>   </td>   <td width="96" style='width:71.95pt;'>     <p class="Text"><span class="CodeInlineChar"><span style='font-size: 11.0pt;'>fSortDes </span> </span></p>   </td>   <td width="314" style='width:235.8pt;'>     <p class="Text">1= If sorted on this field, this field should be sorted in descending order</p>   </td> </tr> <tr>   <td width="59" style='width:44.5pt;'>     <p class="Text">&nbsp; </p>   </td>   <td width="53" style='width:39.6pt;'>     <p class="Text">10-3</p>   </td>   <td width="72" style='width:54.15pt;'>     <p class="Text">07F8h</p>   </td>   <td width="96" style='width:71.95pt;'>     <p class="Text"><span class="CodeInlineChar"><span style='font-size: 11.0pt;'>iSortKey </span> </span></p>   </td>   <td width="314" style='width:235.8pt;'>     <p class="Text"><span>Sort order<br /> 0= Not sorted on this field<br /> 1= This field is the first sort key<br /> 2= This field is the second sort key<br /> 3= This field is the third sort key </span></p>   </td> </tr> <tr>   <td width="59" style='width:44.5pt;'>     <p class="Text">&nbsp; </p>   </td>   <td width="53" style='width:39.6pt;'>     <p class="Text">11</p>   </td>   <td width="72" style='width:54.15pt;'>     <p class="Text">0800h</p>   </td>   <td width="96" style='width:71.95pt;'>     <p class="Text"><span class="CodeInlineChar"><span style='font-size: 11.0pt;'>fRowNums </span> </span></p>   </td>   <td width="314" style='width:235.8pt;'>     <p class="Text">1= This column contains the row numbers for the returned records</p>   </td> </tr> <tr>   <td width="59" style='width:44.5pt;'>     <p class="Text">&nbsp; </p>   </td>   <td width="53" style='width:39.6pt;'>     <p class="Text">12</p>   </td>   <td width="72" style='width:54.15pt;'>     <p class="Text">1000h</p>   </td>   <td width="96" style='width:71.95pt;'>     <p class="Text">(Reserved)</p>   </td>   <td width="314" style='width:235.8pt;'>     <p class="Text">Reserved; must be zero</p>   </td> </tr> <tr>   <td width="59" style='width:44.5pt;'>     <p class="Text">&nbsp; </p>   </td>   <td width="53" style='width:39.6pt;'>     <p class="Text">13</p>   </td>   <td width="72" style='width:54.15pt;'>     <p class="Text">2000h</p>   </td>   <td width="96" style='width:71.95pt;'>     <p class="Text"><span class="CodeInlineChar"><span style='font-size: 11.0pt;'>fSorted </span> </span></p>   </td>   <td width="314" style='width:235.8pt;'>     <p class="Text">1= This column is included in the sort range</p>   </td> </tr> <tr>   <td width="59" style='width:44.5pt;'>     <p class="Text">&nbsp; </p>   </td>   <td width="53" style='width:39.6pt;'>     <p class="Text">15-14</p>   </td>   <td width="72" style='width:54.15pt;'>     <p class="Text">C000h</p>   </td>   <td width="96" style='width:71.95pt;'>     <p class="Text">(Reserved)</p>   </td>   <td width="314" style='width:235.8pt;'>     <p class="Text">Reserved; must be zero</p>   </td> </tr> <tr>   <td width="59" style='width:44.5pt;'>     <p class="Text">2</p>   </td>   <td width="53" style='width:39.6pt;'>     <p class="Text">0</p>   </td>   <td width="72" style='width:54.15pt;'>     <p class="Text">0001h</p>   </td>   <td width="96" style='width:71.95pt;'>     <p class="Text"><span class="CodeInlineChar"><span style='font-size: 11.0pt;'>fClipped </span></p>   </td>   <td width="314" style='width:235.8pt;'>     <p class="Text">1= This column falls outside the worksheet range</p>   </td> </tr> <tr style=''>   <td width="59" style='width:44.5pt;'>     <p class="Text">&nbsp; </p>   </td>   <td width="53" style='width:39.6pt;'>     <p class="Text">15-1</p>   </td>   <td width="72" style='width:54.15pt;'>     <p class="Text">FFFEh</p>   </td>   <td width="96" style='width:71.95pt;'>     <p class="Text">(Reserved)</p>   </td>   <td width="314" style='width:235.8pt;'>     <p class="Text">Reserved; must be zero</p>   </td> </tr></table>     <p class="TableSpacingAfter">&nbsp; </p></div></body></html>